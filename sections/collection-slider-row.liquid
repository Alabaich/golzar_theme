<style>
  .collection-slider-section {
    overflow: hidden;
  }

  .section-header {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    margin-bottom: 25px;
    padding: 0 10px;
    position: relative;
  }

  .header-content {
    text-align: left;
    max-width: 800px;
  }

  .section-title {
    margin: 0 0 10px;
    color: #2c2d2c;
    font-weight: 700;
    max-width: 100%;
    line-height: 1.1;
    letter-spacing: -0.02em;
  }

  .section-description {
    margin-top: 10px;
    max-width: 800px;
  }

  .section-description p {
    margin-bottom: 10px;
  }

  .section-description p:last-child {
    margin-bottom: 0;
  }

  .read-more-btn {
    display: inline-block;
    background: none;
    border: none;
    padding: 0;
    color: #333;
    text-decoration: underline;
    text-underline-offset: 4px;
    font-weight: 600;
    font-size: 0.9rem;
    cursor: pointer;
    margin-top: 5px;
    transition: opacity 0.2s ease;
  }

  .read-more-btn:hover {
    opacity: 0.7;
  }

  .description-short {
    display: block;
  }

  .description-full {
    display: none;
  }

  .view-all-wrapper {
    display: flex;
    justify-content: center;
    margin-top: 30px;
    width: 100%;
  }

  .view-all-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 12px 30px;
    background-color: #002642;
    color: #ffffff;
    border: 2px solid #002642;
    border-radius: 50px;
    font-size: 0.9em;
    font-weight: 300;
    cursor: pointer;
    transition: background-color 0.3s ease
    , color 0.3s ease
    , border-color 0.3s ease;
    text-align: center;
    text-decoration: none;
    min-width: 200px;
  }

  .view-all-btn:hover {
    background-color: #003366;
    border-color: #003366;
    color: #ffffff;
  }

  .slider-wrapper {
    position: relative;
    padding: 10px 0 20px;
  }

  .slider-container {
    display: flex;
    gap: 25px;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    scrollbar-width: none;
    -ms-overflow-style: none;
    padding: 10px 2px;
  }

  .slider-container::-webkit-scrollbar {
    display: none;
  }

  .slider-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background-color: #ffffff;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border: 1px solid #f0f0f0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    color: #333;
  }

  .slider-arrow:hover {
    background-color: #000;
    color: #fff;
    border-color: #000;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  }

  .slider-arrow--prev {
    left: 0;
  }

  .slider-arrow--next {
    right: 0;
  }

  .slider-arrow svg {
    width: 20px;
    height: 20px;
  }

  .slider-product-card {
    flex: 0 0 280px;
    scroll-snap-align: start;
    display: flex;
    flex-direction: column;
    text-decoration: none;
    color: inherit;
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease
    , box-shadow 0.3s ease;
  }

  .slider-product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  }

  .slider-img-wrapper {
    width: 100%;
    aspect-ratio: 1 / 1;
    overflow: hidden;
    background-color: #f8f8f8;
    position: relative;
  }

  .slider-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .slider-product-card:hover .slider-img {
    transform: scale(1.05);
  }

  .slider-info {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    flex-grow: 1;
  }

  .slider-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0;
    line-height: 1.3;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .slider-vendor {
    font-size: 0.85rem;
    color: #777;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .slider-price {
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: auto;
    padding-top: 5px;
  }

  .slider-price s {
    color: #aaa;
    font-size: 0.9rem;
    font-weight: 400;
    margin-left: 8px;
  }

  @media (max-width: 768px) {
    .section-header {
      padding: 0;
    }

    .slider-product-card {
      flex: 0 0 240px;
    }

    .slider-arrow {
      display: none;
    }

    .slider-container {
      padding: 10px 5px;
    }
  }
</style>

<div class="collection-slider-section pageWidth page-width" id="slider-{{ section.id }}">

  <div class="section-header">
    <div class="header-content">
      {% if section.settings.heading != blank %}
        <h2 class="section-title">{{ section.settings.heading | escape }}</h2>
      {% endif %}

      {% if section.settings.description != blank %}
        {% assign content = section.settings.description %}
        {% assign word_count = content | strip_html | split: ' ' | size %}

        <div class="section-description" id="desc-{{ section.id }}">
          {% if word_count > 35 %}
            <div class="description-short">
              {{ content | truncatewords: 35, "..." }}
            </div>
            <div class="description-full">
              {{ content }}
            </div>
            <button class="read-more-btn" onclick="toggleDescription('{{ section.id }}')">Read more</button>
          {% else %}
            {{ content }}
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>

  <div class="slider-wrapper">

    <button class="slider-arrow slider-arrow--prev" aria-label="Previous">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="2"
        stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M15.75 19.5L8.25 12l7.5-7.5" />
      </svg>
    </button>
    <button class="slider-arrow slider-arrow--next" aria-label="Next">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="2"
        stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M8.25 4.5l7.5 7.5-7.5 7.5" />
      </svg>
    </button>

    <div class="slider-container">
      {% assign collection = collections[section.settings.collection] %}

      {% if collection != blank and collection.products_count > 0 %}
        {% for product in collection.products limit: section.settings.limit %}
          <a href="{{ product.url }}" class="slider-product-card">
            <div class="slider-img-wrapper">
              {% if product.featured_image %}
                {{ product.featured_image | image_url: width: 600 | image_tag: loading: 'lazy', class: 'slider-img' }}
              {% else %}
                {{ 'product-1' | placeholder_svg_tag: 'slider-img' }}
              {% endif %}
            </div>
            <div class="slider-info">
              {% if section.settings.show_vendor %}
                <span class="slider-vendor">{{ product.vendor }}</span>
              {% endif %}
              <h3 class="slider-title">{{ product.title }}</h3>
              <div class="slider-price">
                {% if product.compare_at_price > product.price %}
                  <span style="color: #d9534f;">{{ product.price | money }}</span>
                  <s>{{ product.compare_at_price | money }}</s>
                {% else %}
                  <span>{{ product.price | money }}</span>
                {% endif %}
              </div>
            </div>
          </a>
        {% endfor %}
      {% else %}
        {% for i in (1..6) %}
          <div class="slider-product-card">
            <div class="slider-img-wrapper">
              {{ 'product-' | append: i | placeholder_svg_tag: 'slider-img' }}
            </div>
            <div class="slider-info">
              <span class="slider-vendor">Brand</span>
              <h3 class="slider-title">Example Product {{ i }}</h3>
              <div class="slider-price">$99.00</div>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>
  </div>

  {% if section.settings.collection != blank %}
    <div class="view-all-wrapper">
      <a href="{{ collections[section.settings.collection].url }}" class="view-all-btn">
        {{ section.settings.link_text | default: 'View Collection' }}
      </a>
    </div>
  {% endif %}
</div>

<script>
  function toggleDescription(id) {
    const container = document.getElementById('desc-' + id);
    const shortText = container.querySelector('.description-short');
    const fullText = container.querySelector('.description-full');
    const btn = container.querySelector('.read-more-btn');
  
    if (shortText.style.display === 'none') {
      shortText.style.display = 'block';
      fullText.style.display = 'none';
      btn.innerText = 'Read more';
    } else {
      shortText.style.display = 'none';
      fullText.style.display = 'block';
      btn.innerText = 'Read less';
    }
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    const section = document.getElementById('slider-{{ section.id }}');
    const container = section.querySelector('.slider-container');
    const prevBtn = section.querySelector('.slider-arrow--prev');
    const nextBtn = section.querySelector('.slider-arrow--next');
  
    if (!container || !prevBtn || !nextBtn) return;
  
    const scrollStep = 305;
  
    prevBtn.addEventListener('click', () => {
      container.scrollBy({ left: -scrollStep, behavior: 'smooth' });
    });
  
    nextBtn.addEventListener('click', () => {
      container.scrollBy({ left: scrollStep, behavior: 'smooth' });
    });
  });
</script>

{% schema %}
  {
    "name": "Collection Slider Row",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "Featured Collection"
      },
      {
        "type": "richtext",
        "id": "description",
        "label": "Description",
        "default": "<p>Write a description for this collection here.</p>"
      },
      {
        "type": "collection",
        "id": "collection",
        "label": "Select Collection"
      },
      {
        "type": "text",
        "id": "link_text",
        "label": "Link Text",
        "default": "View Collection"
      }, {
        "type": "range",
        "id": "limit",
        "min": 4,
        "max": 20,
        "step": 1,
        "label": "Product Limit",
        "default": 8
      }, {
        "type": "checkbox",
        "id": "show_vendor",
        "label": "Show Vendor",
        "default": true
      }
    ],
    "presets": [
      {
        "name": "Collection Slider Row"
      }
    ]
  }
{% endschema %}