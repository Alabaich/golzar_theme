{% comment %}
  ** SEO-Optimized FAQ Section with Dropdowns **
  - Built with Shopify's block system for easy customization.
  - Uses <details> and <summary> for a native, accessible, no-JavaScript accordion.
  - Implements 'FAQPage' JSON-LD schema for maximum SEO impact and rich snippets in search results.
  - Questions and answers use 'richtext' to allow for bolding, links, etc.
{% endcomment %}

<style>
  .faq-section {
    padding: 50px 20px;
    background-color: #f9f9f9;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    display: flex; 
    justify-content: center;
    align-items: center;
  }
  .faq-main-heading {
    text-align: center;
    font-size: 2.5rem;
    margin-bottom: 40px;
    color: #1a1a1a;
  }
  .faq-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  .faq-item {
    background-color: #ffffff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    overflow: hidden;
    transition: box-shadow 0.3s ease;
  }
  .faq-item:hover {
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
  }
  .faq-question {
    font-weight: 600;
    padding: 20px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    list-style: none; /* Removes the default marker */
    color: #333;
  }
  .faq-question::-webkit-details-marker {
    display: none; /* Hides default marker in Safari */
  }
  .faq-question-text {
    margin: 0;
    font-size: inherit; /* Inherits size from summary */
    font-weight: inherit;
  }
  .faq-answer {
    padding: 0 20px 20px 20px;
    color: #555;
    line-height: 1.6;
  }
  .faq-answer > *:first-child {
    margin-top: 0;
  }
  .faq-answer a {
    color: #007bff;
    text-decoration: none;
  }
  .faq-answer a:hover {
    text-decoration: underline;
  }

  /* --- Icon Styling --- */
  .faq-icon {
    width: 1em;
    height: 1em;
    transition: transform 0.3s ease;
    position: relative;
  }
  .faq-icon::before,
  .faq-icon::after {
    content: '';
    position: absolute;
    background-color: #333;
    border-radius: 2px;
    transition: transform 0.3s ease, opacity 0.3s ease;
  }
  .faq-icon::before { /* Horizontal line */
    width: 100%;
    height: 2px;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
  }
  .faq-icon::after { /* Vertical line */
    width: 2px;
    height: 100%;
    left: 50%;
    top: 0;
    transform: translateX(-50%);
  }
  details[open] > summary .faq-icon {
    transform: rotate(135deg);
  }
</style>

<section
  class="faq-section"
  id="section-{{ section.id }}"
  aria-label="{{ section.settings.heading | default: 'Frequently Asked Questions' | escape }}"
>
  <div class="faq-container page-width">
    {% if section.settings.heading != blank %}
      <h2 class="faq-main-heading" id="faq-heading-{{ section.id }}">
        {{ section.settings.heading | escape }}
      </h2>
    {% endif %}

    <div class="faq-list" role="list" aria-labelledby="faq-heading-{{ section.id }}">
      {% for block in section.blocks %}
        {% comment %}
          The <details> element is a semantic and accessible way to create accordions.
          The 'open' attribute controls its state.
        {% endcomment %}
        <details
          class="faq-item"
          id="faq-item-{{ block.id }}"
          role="listitem"
          {% if forloop.first and section.settings.first_item_open %}open{% endif %}
        >
          {% comment %}
            The <summary> element is the clickable question part.
            It's semantically a heading for the answer's content.
            ARIA attributes enhance accessibility for screen readers.
          {% endcomment %}
          <summary class="faq-question" aria-controls="faq-answer-{{ block.id }}">
            <h3 class="faq-question-text">
              {{ block.settings.question }}
            </h3>
            <span class="faq-icon" aria-hidden="true"></span>
          </summary>

          {% comment %}
            The answer panel. Rich text allows for formatting like bold, italics, and links.
            The 'itemprop' attributes are for microdata, another form of structured data.
          {% endcomment %}
          <div
            class="faq-answer"
            id="faq-answer-{{ block.id }}"
            role="region"
            aria-labelledby="faq-question-{{ block.id }}"
          >
            {{ block.settings.answer }}
          </div>
        </details>
      {% endfor %}
    </div>
  </div>
</section>

{% comment %}
  ** CRITICAL SEO-IMPACT CODE BELOW **
  This JSON-LD script block creates the structured data for the FAQPage schema.
  This is what allows search engines to understand your content as a Q&A pair
  and potentially display it as a rich snippet in search results.
  It is dynamically generated based on the blocks you add in the theme editor.
{% endcomment %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {% for block in section.blocks %}
      {
        "@type": "Question",
        "name": "{{ block.settings.question | strip_html | escape }}",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "{{ block.settings.answer | strip_html | escape }}"
        }
      }
      {% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>

{% comment %}
  Some basic styling to make the section look clean and professional.
  You can customize this to match your theme's branding.
{% endcomment %}


{% schema %}
{
  "name": "FAQ Section (SEO)",
  "tag": "section",
  "class": "shopify-section-faq-seo",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "checkbox",
      "id": "first_item_open",
      "label": "Open first FAQ item by default",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "richtext",
          "id": "question",
          "label": "Question",
          "info": "Keep questions concise. Use simple paragraph text."
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "info": "You can use bold, italics, and links in the answer."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Section (SEO)",
      "blocks": [
        {
          "type": "faq_item",
          "settings": {
            "question": "<p>What is your return policy?</p>",
            "answer": "<p>We offer a 30-day return policy on all of our products. If you are not satisfied with your purchase, you can return it for a full refund. Use this area to link to your full <a href=\"#\">Return Policy page</a>.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "<p>How long does shipping take?</p>",
            "answer": "<p>Shipping times vary depending on your location. Typically, orders arrive within <strong>3-5 business days</strong> for domestic shipping and 7-14 business days for international shipping.</p>"
          }
        },
        {
          "type": "faq_item",
          "settings": {
            "question": "<p>Do you offer international shipping?</p>",
            "answer": "<p>Yes, we ship to most countries worldwide. Please proceed to checkout to see if we ship to your location and to calculate shipping costs.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}
