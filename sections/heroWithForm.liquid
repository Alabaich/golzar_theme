{% style %}
  /* --- Fonts & Base --- */
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .vip-app-wrapper {
    background-color: {{ section.settings.bg_color }};
    color: #333;
  }

  .vip-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 0 20px;
  }

  /* --- Typography --- */
  .vip-header {
    text-align: center;
    margin-bottom: 60px;
  }

  .vip-title {
    font-weight: 400;
    text-transform: uppercase;
    letter-spacing: 2px;
    font-size: 2rem;
    margin-bottom: 20px;
    color: #111;
  }

  .vip-description {
    font-size: 1rem;
    line-height: 1.6;
    color: #666;
    max-width: 700px;
    margin: 0 auto;
    text-align: center;
  }

  .vip-section-title {
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 1.2rem;
    text-align: center;
    margin: 50px 0 30px;
    color: #444;
  }

  /* --- Form Grid --- */
  .vip-form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
  }

  @media (max-width: 750px) {
    .vip-form-grid {
      grid-template-columns: 1fr;
    }
  }

  /* --- Inputs --- */
  .vip-field-group {
    position: relative;
  }

  .vip-input {
    width: 100%;
    background: #fff; /* Solid white inputs */
    border: 1px solid #d1d1d1; /* Thin classic border */
    padding: 15px;
    font-size: 1rem;
    color: #333;
    border-radius: 0; /* Sharp corners */
    -webkit-appearance: none;
    transition: border-color 0.3s ease;
  }

  .vip-input:focus {
    outline: none;
    border-color: #000;
  }
  
  .vip-input::placeholder {
    color: #888;
  }

  select.vip-input {
    background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23333%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
    background-repeat: no-repeat;
    background-position: right 15px top 50%;
    background-size: 10px auto;
    cursor: pointer;
  }

  /* --- File Upload (Drag & Drop) --- */
  .vip-file-upload {
    border: 1px solid #d1d1d1;
    background: #fff;
    padding: 15px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    position: relative;
    transition: background 0.2s, border 0.2s;
  }

  .vip-file-upload.drag-over {
    background: #f0f0f0;
    border: 1px dashed #000;
  }

  .vip-file-label {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1rem;
    color: #666;
    pointer-events: none; /* Let clicks pass to container */
  }
  
  .vip-file-icon {
    width: 16px;
    height: 16px;
    fill: #999;
  }

  .vip-file-btn {
    font-size: 0.9rem;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: #333;
    pointer-events: none;
  }

  /* The actual hidden input */
  .vip-hidden-file {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
  }

  /* --- Submit Button --- */
  .vip-submit-container {
    text-align: center;
    margin-top: 50px;
  }

  .vip-submit {
    background-color: #000;
    color: #fff;
    border: none;
    padding: 18px 60px;
    font-size: 0.9rem;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    cursor: pointer;
    transition: opacity 0.3s;
  }

  .vip-submit:hover {
    opacity: 0.8;
  }

  /* --- Messages --- */
  .vip-success { color: #4caf50; text-align: center; margin-bottom: 20px; }
  .vip-error { color: #ff6b6b; text-align: center; margin-bottom: 20px; }

  /* Checkbox */
  .vip-checkbox-wrapper {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    margin-top: 30px;
    justify-content: center;
    font-size: 0.9rem;
    color: #666;
  }
  
  .vip-checkbox-wrapper input {
    margin-top: 3px;
  }
{% endstyle %}

<div class="vip-app-wrapper section-{{ section.id }}-padding">
  <div class="vip-container">
    
    <!-- Header -->
    <div class="vip-header">
      {% if section.settings.title != blank %}
        <h1 class="vip-title">{{ section.settings.title }}</h1>
      {% endif %}
      {% if section.settings.description != blank %}
        <div class="vip-description">{{ section.settings.description }}</div>
      {% endif %}
    </div>

    <!-- Form -->
    {% form 'contact', id: 'VipApplicationForm' %}
      
      {% if form.posted_successfully? %}
        <p class="vip-success" tabindex="-1" autofocus>
          Application submitted successfully. We will contact you shortly.
        </p>
      {% elsif form.errors %}
        <div class="vip-error">
          {{ form.errors | default_errors }}
        </div>
      {% endif %}

      <!-- 1. BUSINESS INFORMATION -->
      <h3 class="vip-section-title">Business Information</h3>
      <div class="vip-form-grid">
        <input type="text" name="contact[Business Name]" class="vip-input" placeholder="Business Name*" required>
        
        <select name="contact[Country]" class="vip-input">
          <option value="" disabled selected>Country*</option>
          <option value="United States">United States</option>
          <option value="Canada">Canada</option>
          <option value="United Kingdom">United Kingdom</option>
        </select>

        <input type="text" name="contact[Street]" class="vip-input" placeholder="Street*" required>
        <input type="text" name="contact[Apt]" class="vip-input" placeholder="Apt, Suite, Floor, etc. (optional)">

        <input type="text" name="contact[City]" class="vip-input" placeholder="City*" required>
        <input type="text" name="contact[State]" class="vip-input" placeholder="State/Province">

        <input type="text" name="contact[Zip]" class="vip-input" placeholder="ZIP/Postal Code">
        <select name="contact[Business Type]" class="vip-input">
          <option value="" disabled selected>Primary Business Description*</option>
          <option value="Interior Designer">Interior Designer</option>
          <option value="Architect">Architect</option>
          <option value="Builder/Developer">Builder/Developer</option>
          <option value="Hospitality">Hospitality</option>
        </select>

        <input type="url" name="contact[Website]" class="vip-input" placeholder="Website">
        <input type="url" name="contact[Portfolio]" class="vip-input" placeholder="Portfolio Link">
      </div>

      <!-- 2. SOCIAL MEDIA -->
      <h3 class="vip-section-title">Social Media</h3>
      <div class="vip-form-grid">
        <input type="text" name="contact[Instagram]" class="vip-input" placeholder="Instagram">
        <input type="text" name="contact[Pinterest]" class="vip-input" placeholder="Pinterest">
        <input type="text" name="contact[Houzz]" class="vip-input" placeholder="Houzz">
        <input type="text" name="contact[LinkedIn]" class="vip-input" placeholder="LinkedIn">
      </div>

      <!-- 3. AUTHORIZED CONTACT -->
      <h3 class="vip-section-title">Authorized Contact</h3>
      <div class="vip-description" style="margin-bottom: 20px;">
        Please list the authorized contact for this account.
      </div>
      <div class="vip-form-grid">
        <input type="text" name="contact[First Name]" class="vip-input" placeholder="First Name*" required value="{% if customer %}{{ customer.first_name }}{% endif %}">
        <input type="text" name="contact[Last Name]" class="vip-input" placeholder="Last Name*" required value="{% if customer %}{{ customer.last_name }}{% endif %}">
        
        <input type="text" name="contact[Title]" class="vip-input" placeholder="Title">
        <input type="tel" name="contact[Phone]" class="vip-input" placeholder="Phone*" required value="{% if customer %}{{ customer.phone }}{% endif %}">
        
        <input type="email" name="contact[email]" class="vip-input" placeholder="Email*" required value="{% if customer %}{{ customer.email }}{% endif %}">
        <input type="email" name="contact[Confirm Email]" class="vip-input" placeholder="Confirm Email">
      </div>

      <!-- 4. DOCUMENTS (Drag & Drop) -->
      <h3 class="vip-section-title">Qualifying Business Documents</h3>
      <div class="vip-description" style="margin-bottom: 20px; font-size: 0.9rem;">
        Please attach at least one of the following: Valid membership in a major design organization, Interior design certification, or Business license.
      </div>
      
      <!-- Upload Zone 1 -->
      <div class="vip-file-upload" id="drop-zone-1">
        <div class="vip-file-label">
          <svg class="vip-file-icon" viewBox="0 0 24 24"><path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/></svg>
          <span class="file-text">Add Attachment</span>
        </div>
        <span class="vip-file-btn">CHOOSE FILE</span>
        <!-- Native file input hidden on top -->
        <input type="file" name="contact[business_doc]" class="vip-hidden-file" id="file-input-1">
      </div>

      <h3 class="vip-section-title" style="margin-top: 40px;">Qualifying Tax Exemption Documents</h3>
      <div class="vip-description" style="margin-bottom: 20px; font-size: 0.9rem;">
        If you intend to purchase merchandise for resale, please provide tax exempt documentation.
      </div>

      <!-- Upload Zone 2 -->
      <div class="vip-file-upload" id="drop-zone-2">
        <div class="vip-file-label">
          <svg class="vip-file-icon" viewBox="0 0 24 24"><path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/></svg>
          <span class="file-text">Add Attachment</span>
        </div>
        <span class="vip-file-btn">CHOOSE FILE</span>
        <input type="file" name="contact[tax_doc]" class="vip-hidden-file" id="file-input-2">
      </div>

      <!-- Consent -->
      <div class="vip-checkbox-wrapper">
        <input type="checkbox" name="contact[consent]" id="VipConsent" required>
        <label for="VipConsent">I agree to receive email updates including information about collections, upcoming events and exclusive offers.</label>
      </div>

      <!-- Submit -->
      <div class="vip-submit-container">
        <button type="submit" class="vip-submit">Submit Application</button>
      </div>

    {% endform %}
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Helper function to setup drag and drop
    function setupDragAndDrop(zoneId, inputId) {
      const dropZone = document.getElementById(zoneId);
      const input = document.getElementById(inputId);
      const textSpan = dropZone.querySelector('.file-text');

      // Highlight on drag
      ['dragenter', 'dragover'].forEach(eventName => {
        dropZone.addEventListener(eventName, (e) => {
          e.preventDefault();
          e.stopPropagation();
          dropZone.classList.add('drag-over');
        }, false);
      });

      // Remove highlight
      ['dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, (e) => {
          e.preventDefault();
          e.stopPropagation();
          dropZone.classList.remove('drag-over');
        }, false);
      });

      // Handle Drop
      dropZone.addEventListener('drop', (e) => {
        const dt = e.dataTransfer;
        const files = dt.files;
        input.files = files; // Assign dropped files to input
        updateFileName(files);
      });

      // Handle Click/Select
      input.addEventListener('change', function() {
        updateFileName(this.files);
      });

      function updateFileName(files) {
        if (files && files.length > 0) {
          textSpan.textContent = files[0].name;
          textSpan.style.color = "#000";
          textSpan.style.fontWeight = "bold";
        } else {
          textSpan.textContent = "Add Attachment";
          textSpan.style.color = "#666";
          textSpan.style.fontWeight = "normal";
        }
      }
    }

    setupDragAndDrop('drop-zone-1', 'file-input-1');
    setupDragAndDrop('drop-zone-2', 'file-input-2');
  });
</script>

{% schema %}
{
  "name": "VIP Application Form",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#F9F9F7"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Form Title",
      "default": "RH TRADE APPLICATION"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "RH Trade is a membership program for design, architecture and build professionals working on single-residential projects."
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top Padding",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom Padding",
      "default": 60
    }
  ],
  "presets": [
    {
      "name": "VIP Application Form"
    }
  ]
}
{% endschema %}